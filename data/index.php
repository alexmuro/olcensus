<!---------Google Maps Include //--><script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false"></script><?	 $inscon = mysql_connect("localhost","soundtos_am3081","am1238wk");		if (!$inscon)		{			die('Could not connect: ' . mysql_error());		}		$db = "soundtos_transit";		mysql_select_db($db);				function generateRandomColor(){			$r = dechex(mt_rand(0,255)); // generate the red component			$g = dechex(mt_rand(0,255)); // generate the green component			$b = dechex(mt_rand(0,255)); // generate the blue component			$rgb = $r.$g.$b;			if($r == $g && $g == $b){				$rgb = substr($rgb,0,3); // shorter version			}			return '#'.$rgb;		}include 'drawPoly.php'; ?>


<!---------JQuery Includes //--><script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1/jquery-ui.min.js"></script><script src="js/highcharts.js"></script><script src="js/modules/exporting.js"></script><style>.rounded-corners {     -moz-border-radius: 20px;    -webkit-border-radius: 20px;    -khtml-border-radius: 20px;    border-radius: 20px;}</style>


<script type="text/javascript">var sources = ['sf1','acs5'];var sf1var = ['P0010001','P0030002','P0030003','P0030005','P0040001','P0120002','P0120026','P0180001']var acsvar = ['B00001_001E','B00002_001E','B23001_001E','B25044_003E','B25044_004E','B25119_001E','B08006_008E','B08006_009E','B08006_011E']var pendingRoutes = 0;var numRoutes = 0;var markers = [];var newSize= new google.maps.Size(30,30);var img =  new google.maps.MarkerImage('http://wimweb.net/transit/bus.png',null,null,null,newSize);var gimg =  new google.maps.MarkerImage('http://wimweb.net/transit/g_bus.png',null,null,null,newSize);var point =  new google.maps.LatLng(31.661118,-78.771008);var map;var marker;var gbus;jQuery(document).ready(function(){  $("#sf1").change(function() {		//console.log(); // the selected options’s value		$("#sf1").css("border-color","red");		$("#acs").css("border-color","black");		draw_poly(sources[0],sf1var[$(this).val()]);	});});jQuery(document).ready(function(){  $("#acs").change(function() {		//console.log(); // the selected options’s value		draw_poly(sources[1],acsvar[$(this).val()]);		$("#sf1").css("border-color","black");		$("#acs").css("border-color","red");	});});function success(position) {      var latlng = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);    var yourPos = new google.maps.Marker({      position: latlng,       map: map,       title:"You are here! (at least within a "+position.coords.accuracy+" meter radius)"  });	 //map.setCenter( new google.maps.LatLng(position.coords.latitude, position.coords.longitude));	 //map.setZoom(13);  }function error(msg) {      // console.log(arguments);}function initialize() {
 		var latlng = new google.maps.LatLng(40.273412,-74.407610);	/*Center view of the US	var latlng = new google.maps.LatLng(42.156886,-92.144453);	*/      var myOptions = {      zoom: 9,
      center: latlng,
      mapTypeId: google.maps.MapTypeId.ROADMAP,
	  preserveViewport:true,
	  //panControlOptions: { style: google.maps.ZoomControlStyle.DEFAULT, position: google.maps.ControlPosition.RIGHT_TOP},
	  zoomControlOptions: { style: google.maps.ZoomControlStyle.DEFAULT, position: google.maps.ControlPosition.RIGHT_TOP},
	  mapTypeControlOptions: {style: google.maps.MapTypeControlStyle.DROPDOWN_MENU,position: google.maps.ControlPosition.TOP_RIGHT},
	  streetViewControl: false
    };
	 map = new google.maps.Map(document.getElementById("map_canvas"),myOptions);	 //marker =  new google.maps.Marker({position:point, map:map,title:'bus 1',icon:img});	 //gbus =  new google.maps.Marker({position:point, map:map,title:'bus 2',icon:gimg});	 google.maps.event.addListener(map, 'idle', showMarkers);	 	 draw_poly(sources[0],sf1var[0]);	 //loadLayer ('110042','#0000ff',5);	 //loadLayer ('110001','#00ff00',5);	        	if (navigator.geolocation) {	navigator.geolocation.getCurrentPosition(success, error);	} else {	error('not supported');	}	/*	$(function() {	setTimeout("updatePositions()",3000);	setTimeout("GupdatePositions()",3000);	});	*/
  }  function showMarkers() {		//map.clearOverlays();		var bounds = map.getBounds();		//console.log ('Bounds:'+bounds.getNorthEast() + ' ' + bounds.getSouthWest() +'\n Zoom: '+map.getZoom());		if(map.getZoom() > 13)		{		  var jURL = 	'getLayerID.php?nelat='+bounds.getNorthEast().lat()+'&nelon='+bounds.getNorthEast().lng()+'&swlat='+bounds.getSouthWest().lat()+'&swlon='+bounds.getSouthWest().lng();			  //console.log('loading bus route:... \n' + jURL);		  $.ajax({				url:  jURL,				dataType: "json",				global: false, 				//type: "POST", 				//data: ({fips:fips,stid:stid,year:year,month:month,direction:dir,}), 				cache: true,				success: function(data) {					for (x in data)					{						//console.log(data[x]["shape_id"]);						loadLayer(data[x]["shape_id"],'#0000cc',3,bounds);					}								},				error: function (XMLHttpRequest, textStatus, errorThrown) {					//console.error("XMLHttpRequest="+XMLHttpRequest.responseText+"\ntextStatus="+textStatus+"\nerrorThrown="+errorThrown);				}			});							}	 	 // Call you server with ajax passing it the bounds    // In the ajax callback delete the current markers and add new markers   }    function loadLayer(layerID,color,sWeight,bounds)  {		var jURL = 	'getLayer.php?layerID='+layerID+'&nelat='+bounds.getNorthEast().lat()+'&nelon='+bounds.getNorthEast().lng()+'&swlat='+bounds.getSouthWest().lat()+'&swlon='+bounds.getSouthWest().lng();		pendingRoutes = pendingRoutes+1;		$.ajax({			url: jURL,			dataType: "json",			success: function(data){				var lineLayer = new Array();				for (x in data)				{					lineLayer[x] =  new google.maps.LatLng(data[x]["shape_pt_lat"],data[x]["shape_pt_lon"]);					}				var busRoute = new google.maps.Polyline({					path: lineLayer,					strokeColor: color,					strokeOpacity: 0.9,					strokeWeight: sWeight				});				busRoute.setMap(map);				numRoutes = numRoutes+1;				//console.log('Added Route '+ layerID + ' '+ numRoutes+'/'+pendingRoutes);							},			error: function (XMLHttpRequest, textStatus, errorThrown) {				//console.error("XMLHttpRequest="+XMLHttpRequest.responseText+"\ntextStatus="+textStatus+"\nerrorThrown="+errorThrown);			}		});		 } function get_random_color() {    var letters = '0123456789ABCDEF'.split('');    var color = '#';    for (var i = 0; i < 6; i++ ) {        color += letters[Math.round(Math.random() * 15)];    }    return color;} function updatePositions(){	$.ajax({		url: "updatePosition.php",		dataType: "json",		global: false, 		//type: "POST", 		//data: ({fips:fips,stid:stid,year:year,month:month,direction:dir,}), 		cache: true,		success: function(data) {			for (x in data)			{				marker.setPosition(new google.maps.LatLng(data[x]["shape_pt_lat"], data[x]["shape_pt_lon"]));			}			setTimeout("updatePositions()",3000);		},		error: function (XMLHttpRequest, textStatus, errorThrown) {				//console.log("XMLHttpRequest="+XMLHttpRequest.responseText+"\ntextStatus="+textStatus+"\nerrorThrown="+errorThrown);		}	}); } function GupdatePositions(){	$.ajax({		url: "updatePositionG.php",		dataType: "json",		global: false, 		//type: "POST", 		//data: ({fips:fips,stid:stid,year:year,month:month,direction:dir,}), 		cache: true,		success: function(data) {			for (x in data)			{				gbus.setPosition(new google.maps.LatLng(data[x]["shape_pt_lat"], data[x]["shape_pt_lon"]));			}			setTimeout("GupdatePositions()",3000);		},		error: function (XMLHttpRequest, textStatus, errorThrown) {				//console.log("XMLHttpRequest="+XMLHttpRequest.responseText+"\ntextStatus="+textStatus+"\nerrorThrown="+errorThrown);		}	}); }  
</SCRIPT>
<style type="text/css"> </style>
</head>
<body onload="initialize()" style="margin-top:0px">  <!-- Map Canvas - Top 50% of the screen   <div id="data_pane" style="position:absolute;bottom:10px;right:10px:width:200px:height:100px;">test 123</div>	
  <div id="map_canvas" style="width:100%;height:100%;"></div>-->  <div id="stuff"  class="rounded-corners" style="position:absolute;top:10px;right:110px;background-color:#fff;width:300px;height:125px; z-index: 99; ">	<div style='padding:10px;'>		<div id="menu"><b>Info Pane</b></div>		<div id="names"></div>	</div>  </div>    <div id="legend" class="rounded-corners" style="position:absolute;top:10px;left:90px;background-color:#fff;width:200px;height:300px; z-index: 99; ">	  </div>  <div id="censusControl" class="rounded-corners" style="position:absolute;top:330px;left:90px;background-color:#fff;width:200px;height:150px; z-index: 99; ">    <div style='padding:10px;'>	<b>Select a variable to display</b><br>	Summary File 1 Variables:<br>	<select id="sf1" style='border-color:red;'>	 <option value="0" selected>Total Population</option>	 <option value="1">White Population</option>	 <option value="2">Black Population</option>	 <option value="3">Asian Population</option>	 <option value="4">Hispanic Population</option>	 <option value="5">Male Population</option>	 <option value="6">Female Population</option>	 <option value="7">Total Households</option>	 	</select>	American Community Survey Variables:<br>	<select id="acs">	<option value="0"></option>	 <option value="0"> Population Sample </option>	 <option value="1"> Housing Units Sample</option>	 <option value="2">Population in Poverty</option>	 <option value="3">HH with 0 Vehicles</option>	 <option value="4">HH with 1 Vehicles</option>	 <option value="5">Median Household Income</option>	 <option value="6">Transportation: Public Transit</option>	 <option value="7">Transportation: Bus or Trolley</option>	 <option value="7">Transportation: Subway</option>	</select>	</div>  </div>    <div id="container" class="rounded-corners" style="position:absolute;top:145px;right:110px;background-color:#fff;width:300px;height:325px; z-index: 99;">	<div style='padding:10px;'>		<div id="">Graphing		</div>	</div>  </div>  <div id="map_canvas" style="width:100%;height:100%;border:solid green 3px;"></div>         
</body>
</html>